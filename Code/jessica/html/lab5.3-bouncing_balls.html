<html>
    <head>
        <script>
        </script>
        <style>
            canvas {
                border: 5px solid;
                display: block;
                margin-left: auto;
                margin-right: auto;
            }
        </style>
    </head>
    <body>
        <canvas id="cnv" width="500" height="500">
        </canvas>
        <script>
            var cnv = document.getElementById('cnv');
            //var width = 500;
            //var height = 500;
            var balls = [];
            for (var i = 0; i < 1000; ++i) {
                var ball = {
                    radius: 4,
                    px: Math.random()*cnv.width,
                    py: Math.random()*cnv.height,
                    vx: (2*Math.random()-1)*10,
                    vy: (2*Math.random()-1)*10
                };
                balls.push(ball);
            }
            //requestAnimationFrame
            function main_loop() {
                var cnv = document.getElementById('cnv');
                // update the ball's position

                for (var i = 0; i < balls.length; i++) {
                    var ball = balls[i];

                    ball.px += ball.vx;
                    ball.py += ball.vy;

                    // check boundaries
                    if (ball.px < 0) {
                        ball.px = 0;
                        ball.vx *= -1;
                    }
                    else if (ball.px > cnv.width) {
                        ball.px = cnv.width;
                        ball.vx *= -1;
                    }
                    else if (ball.py < 0) {
                        ball.py = 0;
                        ball.vy *= -1;
                    }
                    else if (ball.py > cnv.height) {
                        ball.py = cnv.height;
                        ball.vy *= -1;
                    }
                }
                // draw the ball
                var ctx = cnv.getContext("2d");
                ctx.clearRect(0, 0, cnv.width, cnv.height); //remove this and get a streaking effect
                ctx.fillStyle = "#000000";
                for (i = 0; i < balls.length; i++) {
                    var ball = balls[i];
                    ctx.fillRect(ball.px-ball.radius, ball.py-ball.radius, 2*ball.radius, 2*ball.radius);
                }
                window.requestAnimationFrame(main_loop);
            }
            window.requestAnimationFrame(main_loop);
        </script>
    </body>
</html>